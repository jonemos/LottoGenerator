<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Lotto 6/45 추천번호</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
</head>
<body>
  <div class="lotto-container">
    <div class="lotto-header">
      <h1>동행복권<br><span>Lotto 6/45</span></h1>
    </div>

    <div class="lotto-grid">
      {% for i in range(1, 46) %}
      <div class="lotto-number">{{ i }}</div>
      {% endfor %}
    </div>

    <div class="recommend-section">
      <p>추천번호</p>
      <div class="recommend-numbers" id="recommend-numbers">
        {% for numbers in lotto_numbers %}
          {% for number in numbers %}
            <div class="lotto-ball-win">{{ number }}</div>
          {% endfor %}
        {% endfor %}
      </div>
      <button class="generate-btn" onclick="generateNewNumbers()">
        🎲 새 번호 생성
      </button>

    </div>

    <div class="results">
      <h2>회차별 당첨번호</h2>
      {% for result in latest_results %}
      <div class="draw-card">
        <div class="draw-header">제 {{ result.draw_no }} 회</div>
        <div class="draw-numbers">
          {% for num in result.numbers %}
            <div class="lotto-ball" style="{{ get_ball_style(num) }}">{{ num }}</div>
          {% endfor %}
          <span class="plus">+</span>
          <div class="lotto-ball bonus" style="{{ get_ball_style(result.bonus) }}">{{ result.bonus }}</div>
        </div>
      </div>
      {% endfor %}
    </div>

  </div>

  <script>
    function generateNewNumbers() {
      fetch('/generate-numbers')
        .then(response => response.json())
        .then(data => {
          const recommendBox = document.getElementById('recommend-numbers');
          recommendBox.innerHTML = '';

          const recommendedSet = new Set(); // 추천번호 저장
          data.lotto_numbers.forEach(numbers => {
            numbers.forEach(num => {
              const ball = document.createElement('div');
              ball.className = 'lotto-ball-win';
              ball.textContent = num;

              // 공 색상 적용
              if (num <= 10) {
                ball.style.backgroundColor = '#fbc400'; // Yellow
                ball.style.color = '#000';
              } else if (num <= 20) {
                ball.style.backgroundColor = '#69c8f2'; // Blue
                ball.style.color = '#000';
              } else if (num <= 30) {
                ball.style.backgroundColor = '#ff7272'; // Red
                ball.style.color = '#000';
              } else if (num <= 40) {
                ball.style.backgroundColor = '#aaa'; // Gray
                ball.style.color = '#000';
              } else {
                ball.style.backgroundColor = '#b0d840'; // Green
                ball.style.color = '#000';
              }

              recommendBox.appendChild(ball);
              recommendedSet.add(num);
            });
          });

          // 버튼 강조 처리
          const allButtons = document.querySelectorAll('.lotto-number');
          allButtons.forEach(btn => {
            const num = parseInt(btn.textContent);
            if (recommendedSet.has(num)) {
              btn.style.backgroundColor = '#333';
              btn.style.color = '#fff';
              btn.style.fontWeight = 'bold';
            } else {
              btn.style.backgroundColor = '#fff';
              btn.style.color = '#f27171';
              btn.style.fontWeight = 'normal';
            }
          });
        })
        .catch(error => console.error('Error:', error));
    }
  </script>
</body>
</html>
